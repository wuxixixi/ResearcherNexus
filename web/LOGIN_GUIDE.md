# ResearcherNexus 登录系统使用指南

## 概述

我们为 ResearcherNexus 项目添加了一个完整的用户认证系统，包括登录和注册功能，使用 CSV 文件存储用户凭据。

## 功能特性

- 🔐 用户名/密码认证
- 📝 用户注册功能
- 📁 CSV 文件存储用户数据
- 🛡️ 路由保护（保护 `/chat` 页面）
- 🚪 完整的登录/登出流程
- 💾 本地存储认证状态
- 🔙 便捷的导航（返回主页按钮）

## 默认用户账户

系统预设了以下测试账户：

| 用户名 | 密码     |
|--------|----------|
| admin  | admin123 |
| user   | password |
| test   | test123  |
| demo   | demo456  |

## 使用流程

### 新用户注册
1. **访问主页**: 打开 `http://localhost:3000`
2. **点击"注册账户"**: 会跳转到注册页面 `/auth/register`
3. **填写注册信息**: 
   - 用户名（至少3位，只能包含字母、数字和下划线）
   - 密码（至少6位）
   - 确认密码
4. **提交注册**: 注册成功后会自动跳转到登录页面
5. **使用新账户登录**: 用刚注册的账户登录

### 现有用户登录
1. **访问主页**: 打开 `http://localhost:3000`
2. **点击"开始研究"**: 会跳转到登录页面 `/auth/login`
3. **输入凭据**: 使用现有账户或上述测试账户登录
4. **访问聊天页面**: 登录成功后自动跳转到 `/chat`
5. **登出**: 在聊天页面点击右上角的登出按钮

### 导航功能
- **返回主页**: 在登录和注册页面左上角都有"返回主页"按钮
- **页面切换**: 登录页面可以跳转到注册页面，反之亦然

## 文件结构

```
web/
├── users.csv                           # 用户数据文件
├── src/
│   ├── app/
│   │   ├── auth/
│   │   │   ├── login/
│   │   │   │   └── page.tsx            # 登录页面
│   │   │   └── register/
│   │   │       └── page.tsx            # 注册页面
│   │   ├── api/
│   │   │   └── auth/
│   │   │       ├── login/
│   │   │       │   └── route.ts        # 登录API
│   │   │       ├── register/
│   │   │       │   └── route.ts        # 注册API
│   │   │       └── logout/
│   │   │           └── route.ts        # 登出API
│   │   └── chat/
│   │       └── page.tsx                # 受保护的聊天页面
│   ├── components/
│   │   └── auth/
│   │       └── ProtectedRoute.tsx      # 路由保护组件
│   ├── hooks/
│   │   └── useAuth.ts                  # 认证Hook
│   └── middleware.ts                   # 路由中间件
```

## 注册验证规则

### 用户名要求
- 长度：3-20位字符
- 格式：只能包含字母、数字和下划线
- 唯一性：不能与现有用户重复

### 密码要求
- 长度：6-50位字符
- 确认：需要两次输入一致

## 添加新用户

除了通过注册页面，也可以手动编辑 `web/users.csv` 文件：

```csv
username,password
admin,admin123
user,password
newuser,newpassword
```

## 安全说明

⚠️ **重要**: 这是一个简化的登录系统，仅用于演示目的。在生产环境中，请考虑以下安全措施：

- 使用加密的密码存储（如 bcrypt）
- 实现 JWT 或 session 管理
- 添加 HTTPS
- 实现密码复杂度要求
- 添加登录尝试限制
- 使用专业的认证服务
- 添加邮箱验证
- 实现密码重置功能

## 技术实现

- **前端**: React + Next.js 15
- **状态管理**: React Hooks + localStorage
- **路由保护**: 客户端组件 + useEffect
- **数据存储**: CSV 文件 + Node.js fs API
- **UI组件**: 基于项目现有的 UI 组件库
- **表单验证**: 客户端和服务端双重验证

## 故障排除

### 注册失败
- 检查用户名是否符合格式要求
- 确认用户名是否已被使用
- 检查密码长度是否符合要求
- 确认两次密码输入是否一致

### 登录失败
- 检查用户名和密码是否正确
- 确认 `users.csv` 文件存在且格式正确
- 检查是否已成功注册

### 页面无法访问
- 确保开发服务器正在运行
- 检查浏览器控制台是否有错误信息
- 确认网络连接正常

### 登录状态丢失
- 检查浏览器的 localStorage 是否被清除
- 刷新页面重新验证登录状态

## 开发模式启动

使用项目根目录的 bootstrap.bat 启动开发模式：

```bash
# 开发模式
.\bootstrap.bat -d

# 生产模式
.\bootstrap.bat
``` 